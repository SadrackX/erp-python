{% extends 'base.html' %}
{% block conteudo %}
    <h3>Pedidos</h3>
    <a href="{{ url_for('pedidos_novo') }}">Cadastrar novo pedido</a>
    <hr>
    <h4>Lista de Pedidos</h4>
    <table border="1" cellpadding="5" cellspacing="0">
        <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Data</th>
            <th>Status</th>
            <th>Total</th>
            <th>Ações</th>
        </tr>
        {% for pedido in pedidos %}
        <tr>
            <td>{{ pedido.id }}</td>
            <td>{{ clientes[pedido.id_cliente] if clientes[pedido.id_cliente] else pedido.id_cliente }}</td>
            <td>{{ pedido.data.strftime('%d/%m/%Y %H:%M') if pedido.data else '' }}</td>
            <td>{{ pedido.status }}</td>
            <td>R$ {{ '%.2f' % pedido.total }}</td>
            <td>
                <a href="#">Gerar OS</a>
                <a href="#">Gerar Recibo</a>
                <a href="{{ url_for('pedido_detalhes', pedido_id=pedido.id) }}">Detalhes</a>
                <a href="{{ url_for('pedido_editar', pedido_id=pedido.id) }}">Editar</a>
                {% if pedido.status != 'cancelado' %}
                <a href="{{ url_for('pedido_cancelar', pedido_id=pedido.id) }}" onclick="return confirm('Cancelar este pedido?');">Cancelar</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}
