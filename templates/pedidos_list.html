{% extends 'base.html' %}
{% block conteudo %}
    <h3>Pedidos</h3>
    <a href="{{ url_for('pedidos_novo') }}" class="btn btn-primary">Cadastrar novo pedido</a>
    <hr>
    <h4>Lista de Pedidos</h4>
    <table class="table table-striped" border="1" cellpadding="5" cellspacing="0">
        <thead class="thead-dark">
            <tr>
                <th>ID</th>
                <th>Cliente</th>
                <th>Data</th>
                <th>Status</th>
                <th>Total</th>
                <th>Ações</th>
            </tr>
        </thead>
        {% for pedido in pedidos %}
        <tr>
            <th scope="row">{{ pedido.id }}</th>
            <td>{{ clientes[pedido.id_cliente] if clientes[pedido.id_cliente] else pedido.id_cliente }}</td>
            <td>{{ pedido.data.strftime('%d/%m/%Y %H:%M') if pedido.data else '' }}</td>
            <td>{{ pedido.status }}</td>
            <td>R$ {{ '%.2f' % pedido.total }}</td>
            <td>
                <a href="{{ url_for('pedido_editar', pedido_id=pedido.id) }}" class="btn btn-warning btn-sm">Editar</a>
                {% if pedido.status != 'cancelado' %}
                <a href="{{ url_for('pedido_cancelar', pedido_id=pedido.id) }}" class="btn btn-danger btn-sm" onclick="return confirm('Cancelar este pedido?');">Cancelar</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}